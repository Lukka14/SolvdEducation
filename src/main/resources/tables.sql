-- MySQL Script generated by MySQL Workbench
-- Tue Sep  6 14:53:22 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`professions`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`professions` (
  `idprofessions` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `salary` INT NULL,
  PRIMARY KEY (`idprofessions`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`flags`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`flags` (
  `idflags` INT NOT NULL,
  `color` VARCHAR(45) NULL,
  `name` VARCHAR(45) NULL,
  PRIMARY KEY (`idflags`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`country`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`country` (
  `idcountry` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `location` VARCHAR(45) NULL,
  `flagsid` INT NOT NULL,
  PRIMARY KEY (`idcountry`),
  INDEX `fk_country_flags1_idx` (`flagsid` ASC) ,
  CONSTRAINT `fk_country_flags1`
    FOREIGN KEY (`flagsid`)
    REFERENCES `mydb`.`flags` (`idflags`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`cars`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cars` (
  `idcars` INT NOT NULL,
  `car_brand` VARCHAR(45) NULL,
  `car_model` VARCHAR(45) NULL,
  `price` INT NULL,
  `people_id` INT NOT NULL,
  `country_id` INT NOT NULL,
  PRIMARY KEY (`idcars`),
  INDEX `fk_cars_country1_idx` (`country_id` ASC) ,
  CONSTRAINT `fk_cars_country1`
    FOREIGN KEY (`country_id`)
    REFERENCES `mydb`.`country` (`idcountry`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`animals`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`animals` (
  `idpets` INT NOT NULL,
  `animal_type` VARCHAR(45) NULL,
  `weight` VARCHAR(45) NULL,
  PRIMARY KEY (`idpets`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`pets`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`pets` (
  `idpets` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `animalsid` INT NOT NULL,
  PRIMARY KEY (`idpets`),
  INDEX `fk_pets_animals1_idx` (`animalsid` ASC) ,
  CONSTRAINT `fk_pets_animals1`
    FOREIGN KEY (`animalsid`)
    REFERENCES `mydb`.`animals` (`idpets`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`people`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`people` (
  `idpeople` INT NOT NULL,
  `first_name` VARCHAR(45) NULL,
  `last_name` VARCHAR(45) NULL,
  `professionsid` INT NOT NULL,
  `carsid` INT NOT NULL,
  `pets_idpets` INT NOT NULL,
  PRIMARY KEY (`idpeople`),
  INDEX `fk_people_professions1_idx` (`professionsid` ASC) ,
  INDEX `fk_people_cars1_idx` (`carsid` ASC) ,
  INDEX `fk_people_pets1_idx` (`pets_idpets` ASC) ,
  CONSTRAINT `fk_people_professions1`
    FOREIGN KEY (`professionsid`)
    REFERENCES `mydb`.`professions` (`idprofessions`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_people_cars1`
    FOREIGN KEY (`carsid`)
    REFERENCES `mydb`.`cars` (`idcars`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_people_pets1`
    FOREIGN KEY (`pets_idpets`)
    REFERENCES `mydb`.`pets` (`idpets`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`shops`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`shops` (
  `idshops` INT NOT NULL,
  `address` VARCHAR(45) NULL,
  `name` VARCHAR(45) NULL,
  PRIMARY KEY (`idshops`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`cities`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`cities` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `countryid` INT NOT NULL,
  `shops_idshops` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_cities_country1_idx` (`countryid` ASC) ,
  INDEX `fk_cities_shops1_idx` (`shops_idshops` ASC) ,
  CONSTRAINT `fk_cities_country1`
    FOREIGN KEY (`countryid`)
    REFERENCES `mydb`.`country` (`idcountry`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_cities_shops1`
    FOREIGN KEY (`shops_idshops`)
    REFERENCES `mydb`.`shops` (`idshops`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`driver_licenses`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`driver_licenses` (
  `idlicenses` INT NOT NULL,
  `license_number` VARCHAR(45) NULL,
  `peopleid` INT NOT NULL,
  PRIMARY KEY (`idlicenses`),
  INDEX `fk_driver_licenses_people1_idx` (`peopleid` ASC) ,
  CONSTRAINT `fk_driver_licenses_people1`
    FOREIGN KEY (`peopleid`)
    REFERENCES `mydb`.`people` (`idpeople`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`items`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`items` (
  `iditems` INT NOT NULL,
  `name` VARCHAR(45) NULL,
  `price` INT NULL,
  PRIMARY KEY (`iditems`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`shops_has_items`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`shops_has_items` (
  `id` INT NOT NULL,
  `shops_id` INT NOT NULL,
  `items_id` INT NOT NULL,
  PRIMARY KEY (`id`, `shops_id`, `items_id`),
  INDEX `fk_shops_has_items_items1_idx` (`items_id` ASC) ,
  INDEX `fk_shops_has_items_shops1_idx` (`shops_id` ASC) ,
  CONSTRAINT `fk_shops_has_items_shops1`
    FOREIGN KEY (`shops_id`)
    REFERENCES `mydb`.`shops` (`idshops`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_shops_has_items_items1`
    FOREIGN KEY (`items_id`)
    REFERENCES `mydb`.`items` (`iditems`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`houses`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`houses` (
  `idhouses` INT NOT NULL,
  `address` VARCHAR(45) NULL,
  `cities_id` INT NOT NULL,
  PRIMARY KEY (`idhouses`),
  INDEX `fk_houses_cities1_idx` (`cities_id` ASC) ,
  CONSTRAINT `fk_houses_cities1`
    FOREIGN KEY (`cities_id`)
    REFERENCES `mydb`.`cities` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`house_owners`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`house_owners` (
  `id` INT NOT NULL,
  `houses_owner_id` INT NOT NULL,
  `people_house_id` INT NOT NULL,
  PRIMARY KEY (`houses_owner_id`, `people_house_id`, `id`),
  INDEX `fk_houses_has_people_people1_idx` (`people_house_id` ASC) ,
  INDEX `fk_houses_has_people_houses1_idx` (`houses_owner_id` ASC) ,
  CONSTRAINT `fk_houses_has_people_houses1`
    FOREIGN KEY (`houses_owner_id`)
    REFERENCES `mydb`.`houses` (`idhouses`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_houses_has_people_people1`
    FOREIGN KEY (`people_house_id`)
    REFERENCES `mydb`.`people` (`idpeople`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;


-- delete

DELETE FROM houses;

DELETE FROM cities;

DELETE FROM shops_has_items;

DELETE FROM items WHERE PRICE <150;

DELETE FROM shops;

DELETE FROM pets;

DELETE FROM country;

DELETE FROM professions;

DELETE FROM animals WHERE idpets>0;

DELETE FROM flags;

-- insert

INSERT INTO animals(idpets,animal_type ,weight)
VALUES(1,'dog',15),(2,'parrot',1),(3,'dog',8);

INSERT INTO pets(idpets,name,animalsid)
VALUES(1,'Rexy',1),(2,'Bingo',3),(3,'Molly',2);

INSERT INTO flags(idflags,color,name)
VALUES(1,'blue,white,red','france'),(2,'red,white','georgia');

INSERT INTO country(idcountry,name,location,flagsid)
VALUES(1,'Georgia','East Europe',2),(2,'France','West Europe',1);

INSERT INTO shops(idshops,address,name)
VALUES(1,'18 NW. Circle LaneTualatin','Brunco Cloth'),(2,'6 Valley Farms Street Altoona','Extra');

INSERT INTO cities(id,name,countryid,shops_idshops)
VALUES(1,'Marseille',1,1);

INSERT INTO houses(idhouses,address,cities_id)
VALUES(1,'355 Central Street Saint Louis',1);

INSERT INTO items(iditems,name,price)
VALUES(1,'Shoes',120),(2,'Sweater',70);

INSERT INTO shops_has_items(id,shops_id,items_id)
VALUES(1,1,2),(2,2,1);

INSERT INTO professions(idprofessions,name,salary)
VALUES(1,'Mechanic',800),(2,'Builder',1100),(3,'Waiter',600);

-- update

UPDATE pets
SET animalsid=2
WHERE name='Bingo';

UPDATE shops_has_items
SET shops_id=2,items_id=1
WHERE id=1;

UPDATE shops
SET name='Brunco Cloth 2'
WHERE name='Brunco Cloth';

UPDATE cities 
SET name='Lyon'
WHERE name='Marseille';

UPDATE flags
SET color='White,Red'
WHERE name='georgia';

UPDATE houses
SET address='347 Central Street Saint Louis'
WHERE idhouses=1;

UPDATE shops
SET name='Bruno Fashion'
WHERE address='18 NW. Circle LaneTualatin';

UPDATE professions
SET salary=1400
WHERE salary<1000;

UPDATE shops_has_items
SET shops_id=2,items_id=1
WHERE id=1;

UPDATE pets
SET name = 'Big Bingo'
WHERE name='Bingo';

-- joins

SELECT items.price, pets.name
FROM items
LEFT JOIN pets
ON iditems=idpets;

SELECT cities.name,flags.color
FROM cities
RIGHT JOIN flags
ON countryid=idflags;

SELECT shops.address,houses.address
FROM shops
INNER JOIN houses
ON shops.address=houses.address;

SELECT animals.weight,items.price
FROM animals
LEFT JOIN items
ON weight=price;

SELECT cities.name,pets.name
FROM cities
INNER JOIN pets
ON cities.name=pets.name;

